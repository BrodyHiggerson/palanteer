Extracted from ZSTD at 6a258043f5ed5648ea4a432434001f14f15b138c
